#!/usr/bin/env node

const { Manga } = require("../models");
const { TO_READ, READING, WAITING } = Manga.Shelf;
const MangaService = require("../services/manga-service");
const db = require("../services/db-service");
const { pushMangaNotifications } = require("../services/push-service");

async function main() {
  console.log("Connecting to database");
  await db.ensureDBConnection();

  const filters = {
    shelf: { $in: [TO_READ] },
    isCompleted: false,
  };

  const result = await MangaService.updateMultiple(filters, true, true);
  console.log("------------")
  console.log(result)
  console.log("------------")

  await db.closeDBConnection();
  console.log("DONE");
}

main().catch((err) => {
  console.error(err);
  db.closeDBConnection();
  process.exit(1);
});
